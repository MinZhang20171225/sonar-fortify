
							<h2>ABSTRACT</h2>
							<p>
							   Allowing database persistent entities to be auto-populated by request parameters can allow an attacker to create unintended records in association entities or update unintended fields in the entity object.
							</p>
							<h2>EXPLANATION</h2>
							<p>
							  Model objects are an object-oriented representation of database entities.  <br>		They provide convenience methods to load, store, update, and delete associated database entities.  <br>		Hibernate, the Microsoft .NET Entity framework, and LINQ are examples of Object Relational Mapping (ORM) frameworks <br>		that help you build database-backed model objects.<br>		<br>		Many web frameworks strive to make life easier for developers by providing a mechanism for binding request parameters<br>		 into request-bound objects based on matching request parameter names to model object attribute names <br>		 (based on matching public getter and setter methods).  <br>		 <br>		If an application uses ORM classes as request-bound objects, then it is likely that a request parameter <br>		can modify any field in corresponding model objects and any nested field of an object attribute.  <br>		<br><b>Example 1:</b> The <code>Order</code>, <code>Customer</code>, and <code>Profile</code> are Microsoft .NET Entity persisted classes.<br><pre><br>public class Order {<br>	public string ordered { get; set; }<br>	public List&lt;LineItem&gt; LineItems { get; set; }<br>	pubilc virtual Customer Customer { get; set; }<br>...<br>}<br>public class Customer {<br>	public int CustomerId { get; set; }<br>	...<br>	public virtual Profile Profile { get; set; }<br>...<br>} <br>public class Profile {<br>	public int profileId { get; set; }<br>	public string username { get; set; }<br>	public string password { get; set; }<br>	...<br>}<br></pre><br><code>OrderController</code> is the ASP.NET MVC controller class handling the request:<br><pre><br><br>public class OrderController : Controller{<br>	StoreEntities db = new StoreEntities();<br>...<br>	<br>	public String updateOrder(Order order) {<br>		...<br>		db.Orders.Add(order);<br>		db.SaveChanges();<br>	}<br>}<br></pre><br>Because model entity classes are automatically bound to requests, an attacker can use this vulnerability to update another user's password by adding the following request parameters to the request: &quot;http://www.yourcorp.com/webApp/updateOrder?order.customer.profile.profileId=1234&amp;order.customer.profile.password=urpowned&quot;
							</p>
							 								<h2>REFERENCES</h2>
																								   <p>[1] Standards Mapping - OWASP Top 10 2004 - (OWASP 2004) <em>A1 Unvalidated Input</em> <br></p>
																									   <p>[2] Standards Mapping - OWASP Top 10 2007 - (OWASP 2007) <em>A4 Insecure Direct Object Reference</em> <br></p>
																									   <p>[3] Standards Mapping - OWASP Top 10 2010 - (OWASP 2010) <em>A4 Insecure Direct Object References</em> <br></p>
																									   <p>[4] Standards Mapping - Common Weakness Enumeration - (CWE) <em>CWE ID 20</em> <br></p>
																									   <p>[5] Josh Bush <em>Mass Assignment Vulnerability in ASP.NET MVC</em> <br></p>
																									   <p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 - (PCI 2.0) <em>Requirement 6.5.1</em> <br></p>
																									   <p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 - (PCI 1.2) <em>Requirement 6.5.2</em> <br></p>
																									   <p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 - (PCI 1.1) <em>Requirement 6.5.6</em> <br></p>
																									   <p>[9] Standards Mapping - NIST Special Publication 800-53 Revision 4 - (NIST SP 800-53 Rev.4) <em>SI-10 Information Input Validation</em> <br></p>
																														