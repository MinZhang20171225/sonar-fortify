
							<h2>ABSTRACT</h2>
							<p>
							  An attacker might be able to create unexpected control flow paths through the application, potentially bypassing security checks.
							</p>
							<h2>EXPLANATION</h2>
							<p>
							  If an attacker can supply values that the application then uses to determine which class to instantiate or which method to invoke, the potential exists for the attacker to create control flow paths through the application that were not intended by the application developers. This attack vector may allow the attacker to bypass authentication or access control checks or otherwise cause the application to behave in an unexpected manner. Even the ability to control the arguments passed to a given method or constructor may give a wily attacker the edge necessary to mount a successful attack. <br><br><br><b>Example:</b> A common reason that programmers utilize CallByName is to implement their own command dispatcher. The following example shows a command dispatcher that does not utilize the CallByName function:<br><br><pre><br>...<br>Dim ctl As String<br>Dim ao As new Worker<br>ctl = Request.Form("ctl")<br>If String.Compare(ctl,"Add") = 0 Then<br>	ao.DoAddCommand Request<br>Else If String.Compare(ctl,"Modify") = 0 Then<br>	ao.DoModifyCommand Request<br>Else<br>	App.EventLog "No Action Found", 4<br>End If<br>...<br><br></pre><br><br>A programmer might refactor this code to use reflection as follows:<br><br><pre><br>...<br>Dim ctl As String<br>Dim ao As Worker<br>ctl = Request.Form("ctl")<br>CallByName ao, ctl, vbMethod, Request<br>...<br><br></pre><br><br>The refactoring initially appears to offer a number of advantages. There are fewer lines of code, the <code>if/else</code> blocks have been entirely eliminated, and it is now possible to add new command types without modifying the command dispatcher.<br><br>However, the refactoring allows an attacker to invoke any method implemented by the <code>Worker</code> object. If the command dispatcher is still responsible for access control, then whenever programmers create a new method within the <code>Worker</code> class, they must remember to modify the dispatcher's access control code. If they fail to modify the access control code, then some <code>Worker</code> methods will not have any access control.<br><br>One way to address this access control problem is to make the <code>Worker</code> object responsible for performing the access control check. An example of the re-refactored code follows:<br><br><pre><br>...<br>Dim ctl As String<br>Dim ao As Worker<br>ctl = Request.Form("ctl")<br><b>If ao.checkAccessControl(ctl,Request) = True Then</b><br>	CallByName ao, "Do" &amp; ctl &amp; "Command", vbMethod, Request<br>End If<br>...<br><br></pre><br><br>Although this is an improvement, it encourages a decentralized approach to access control, which makes it easier for programmers to make access control mistakes.<br><br>
							</p>
							 								<h2>REFERENCES</h2>
																								   <p>[1] Standards Mapping - OWASP Top 10 2004 - (OWASP 2004) <em>A1 Unvalidated Input</em> <br></p>
																									   <p>[2] Standards Mapping - OWASP Top 10 2007 - (OWASP 2007) <em>A4 Insecure Direct Object Reference</em> <br></p>
																									   <p>[3] Standards Mapping - OWASP Top 10 2010 - (OWASP 2010) <em>A4 Insecure Direct Object References</em> <br></p>
																									   <p>[4] Standards Mapping - Security Technical Implementation Guide Version 3 - (STIG 3) <em>APP3510 CAT I, APP3570 CAT I</em> <br></p>
																									   <p>[5] Standards Mapping - Common Weakness Enumeration - (CWE) <em>CWE ID 470</em> <br></p>
																									   <p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 - (PCI 1.2) <em>Requirement 6.3.1.1, Requirement 6.5.4</em> <br></p>
																									   <p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 - (PCI 1.1) <em>Requirement 6.5.1</em> <br></p>
																									   <p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 - (PCI 2.0) <em>Requirement 6.5.8</em> <br></p>
																									   <p>[9] Standards Mapping - FIPS200 - (FISMA) <em>SI</em> <br></p>
																														